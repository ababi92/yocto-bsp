[project]
org='seapath'
name='yocto-bsp'

[build]
command='./build.sh -v'
files='build/tmp/deploy/images/votp/seapath-image-votp.wic.gz
       build/tmp/deploy/images/README.pdf'
archive='%Po-%Pn-$(scripts/get-version).tar.gz'
tar_options='-h'
tar_transform='yes'
flavors='
    all
    bios
    bios_dbg
    bios_test
    dbg
    efi
    flash_bios
    flash_efi
    flash_pxe
    guest
    guest_dbg
    guest_host
    guest_host_dbg
    guest_host_test
    guest_test
    sfl_ci
    test
'

[all]
command=' \
    ./build.sh -v && \
    ./build.sh -v -i seapath-bios-dbg-image && \
    ./build.sh -v -i seapath-bios-image && \
    ./build.sh -v -i seapath-bios-test-image && \
    ./build.sh -v -i seapath-dbg-image &&  \
    ./build.sh -v -i seapath-flash-bios --distro votp-flash && \
    ./build.sh -v -i seapath-flash-efi --distro votp-flash && \
    ./build.sh -v -i seapath-flash-pxe --distro votp-flash && \
    ./build.sh -v -i seapath-guest-dbg-image && \
    ./build.sh -v -i seapath-guest-host-dbg-image && \
    ./build.sh -v -i seapath-guest-host-image && \
    ./build.sh -v -i seapath-guest-host-test-image && \
    ./build.sh -v -i seapath-guest-image && \
    ./build.sh -v -i seapath-guest-test-image && \
    ./build.sh -v -i seapath-test-image && \
    ./tools/get-pkg-list-csv.sh ./build/security/manifests/*.manifest > \
        ./build/security/manifests/pkg-list_$(date -u +"%Y-%m-%d_%H:%M:%S").csv \
'

[bios]
command='./build.sh -v -i seapath-bios-image'

[bios_dbg]
command='./build.sh -v -i seapath-bios-dbg-image'

[bios_test]
command='./build.sh -v -i seapath-bios-test-image'

[dbg]
command='./build.sh -v -i seapath-dbg-image'

[efi]
command='./build.sh -v'

[flash_bios]
command='./build.sh -v -i seapath-flash-bios --distro votp-flash'

[flash_efi]
command='./build.sh -v -i seapath-flash-efi --distro votp-flash'

[flash_pxe]
command='./build.sh -v -i seapath-flash-pxe --distro votp-flash'

[guest]
command='./build.sh -v -i seapath-guest-image'

[guest_dbg]
command='./build.sh -v -i seapath-guest-dbg-image'

[guest_host]
command='./build.sh -v -i seapath-guest-host-image'

[guest_host_dbg]
command='./build.sh -v -i seapath-guest-host-dbg-image'

[guest_host_test]
command='./build.sh -v -i seapath-guest-host-test-image'

[guest_test]
command='./build.sh -v -i seapath-guest-test-image'

[sfl_ci]
command=' \
    ./build.sh -v -i seapath-image \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate && \
    ./build.sh -v -i seapath-dbg-image \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate && \
    ./build.sh -v -i seapath-flash-pxe \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate && \
    ./build.sh -v -i seapath-guest-image \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate && \
    ./build.sh -v -i seapath-guest-test-image \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate && \
    ./build.sh -v -i seapath-test-image \
        --dl-dir /mnt/dldir \
        --sstate-dir /mnt/sstate \
'

[test]
command='./build.sh -v -i seapath-test-image'
